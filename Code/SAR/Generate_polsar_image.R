library("png")

fill_matrix <- function(file_HHHH, nrow, ncol) {
  
  intensity_matrix <- matrix(readBin(file_HHHH, double(), n = nrow * ncol, size = 4, endian = "little"), 
    nrow = nrow, ncol = ncol, byrow = TRUE)
  
  return(intensity_matrix)
  
}

equalize <- function(data, nrow, ncol){
  
  data <- matrix(ecdf(data)(data), nrow = nrow, ncol = ncol)
  
  return(data)
}

nrow <- 6512 #Number of rows of the image
ncol <- 3300 #Number of columns of the image

file_HHHH <- file("HHHH.gri", "rb")

intensity_matrix <- fill_matrix(file_HHHH, nrow , ncol)

#Close files
close(file_HHHH)
#Remove file from RAM memory
rm(file_HHHH)

#Direct projection of z on colors' space
equalized_matrix <- equalize(intensity_matrix, nrow, ncol)

#writePNG(equalized_matrix, target = "PolSAR_Image.png")
#writePNG(equalized_matrix[1:600, 1:600], target = "SampleTexture.png")

#Cape Canaveral
#c(50, 128, 1700, 128)
#writePNG(equalized_matrix[50:178, 1700:1828], target = "A_image_from_a_especific_region1.png")
#c(150, 128, 1700, 128)
#writePNG(equalized_matrix[150:278, 1700:1828], target = "A_image_from_a_especific_region2.png")
#c(250, 128, 1700, 12)
#writePNG(equalized_matrix[250:378, 1700:1828], target = "A_image_from_a_especific_region3.png")
#c(350, 128, 1700, 128)
#writePNG(equalized_matrix[350:478, 1700:1828], target = "A_image_from_a_especific_region4.png")
#c(450, 128, 1700, 128)
#writePNG(equalized_matrix[450:578, 1700:1828], target = "A_image_from_a_especific_region5.png")
#c(550, 128, 1700, 128)
#writePNG(equalized_matrix[550:678, 1700:1828], target = "A_image_from_a_especific_region6.png")
#c(650, 128, 1700, 128)
#writePNG(equalized_matrix[650:778, 1700:1828], target = "A_image_from_a_especific_region7.png")
#c(750, 128, 1700, 128)
#writePNG(equalized_matrix[750:878, 1700:1828], target = "A_image_from_a_especific_region8.png")
#c(100, 128, 1700, 128)
#writePNG(equalized_matrix[100:228, 1700:1828], target = "A_image_from_a_especific_region9.png")
#c(200, 128, 1700, 128)
#writePNG(equalized_matrix[200:328, 1700:1828], target = "A_image_from_a_especific_region10.png")

#c(50, 128, 1850, 128)
#writePNG(equalized_matrix[50:178, 1850:1978], target = "A_image_from_a_especific_region51.png")
#c(150, 128, 1850, 128)
#writePNG(equalized_matrix[150:278, 1850:1978], target = "A_image_from_a_especific_region52.png")
#c(250, 128, 1850, 128)
#writePNG(equalized_matrix[250:378, 1850:1978], target = "A_image_from_a_especific_region53.png")
#c(350, 128, 1850, 128)
#writePNG(equalized_matrix[350:478, 1850:1978], target = "A_image_from_a_especific_region54.png")
#c(450, 128, 1850, 128)
#writePNG(equalized_matrix[450:578, 1850:1978], target = "A_image_from_a_especific_region55.png")
#c(550, 128, 1850, 128)
#writePNG(equalized_matrix[550:678, 1850:1978], target = "A_image_from_a_especific_region56.png")
#c(100, 128, 1850, 128)
#writePNG(equalized_matrix[100:228, 1850:1978], target = "A_image_from_a_especific_region57.png")
#c(200, 128, 1850, 128)
#writePNG(equalized_matrix[200:328, 1850:1978], target = "A_image_from_a_especific_region58.png")
#c(300, 128, 1850, 128)
#writePNG(equalized_matrix[300:428, 1850:1978], target = "A_image_from_a_especific_region59.png")
#c(400, 128, 1850, 128)
#writePNG(equalized_matrix[400:528, 1850:1978], target = "A_image_from_a_especific_region60.png")

#c(50, 128, 1550, 128)
#writePNG(equalized_matrix[50:178, 1550:1678], target = "A_image_from_a_especific_region61.png")
#c(150, 128, 1550, 128)
#writePNG(equalized_matrix[150:278, 1550:1678], target = "A_image_from_a_especific_region62.png")
#c(250, 128, 1550, 128)
#writePNG(equalized_matrix[250:378, 1550:1678], target = "A_image_from_a_especific_region63.png")
#c(350, 128, 1550, 128)
#writePNG(equalized_matrix[350:478, 1550:1678], target = "A_image_from_a_especific_region64.png")
#c(450, 128, 1550, 128)
#writePNG(equalized_matrix[450:578, 1550:1678], target = "A_image_from_a_especific_region65.png")
#c(550, 128, 1550, 128)
#writePNG(equalized_matrix[550:678, 1550:1678], target = "A_image_from_a_especific_region66.png")
#c(650, 128, 1550, 128)
#writePNG(equalized_matrix[650:778, 1550:1678], target = "A_image_from_a_especific_region67.png")
#c(750, 128, 1550, 128)
#writePNG(equalized_matrix[750:878, 1550:1678], target = "A_image_from_a_especific_region68.png")
#c(800, 128, 1550, 128)
#writePNG(equalized_matrix[800:928, 1550:1678], target = "A_image_from_a_especific_region69.png")
#c(850, 128, 1550, 128)
#writePNG(equalized_matrix[850:978, 1550:1678], target = "A_image_from_a_especific_region70.png")

#c(50, 128, 1400, 128)
#writePNG(equalized_matrix[50:178, 1400:1528], target = "A_image_from_a_especific_region71.png")
#c(150, 128, 1400, 128)
#writePNG(equalized_matrix[150:278, 1400:1528], target = "A_image_from_a_especific_region72.png")
#c(250, 128, 1400, 128)
#writePNG(equalized_matrix[250:378, 1400:1528], target = "A_image_from_a_especific_region73.png")
#c(350, 128, 1400, 128)
#writePNG(equalized_matrix[350:478, 1400:1528], target = "A_image_from_a_especific_region74.png")
#c(450, 128, 1400, 128)
#writePNG(equalized_matrix[450:578, 1400:1528], target = "A_image_from_a_especific_region75.png")
#c(550, 128, 1400, 128)
#writePNG(equalized_matrix[550:678, 1400:1528], target = "A_image_from_a_especific_region76.png")
#c(650, 128, 1400, 128)
#writePNG(equalized_matrix[650:778, 1400:1528], target = "A_image_from_a_especific_region77.png")
#c(750, 128, 1400, 128)
#writePNG(equalized_matrix[750:878, 1400:1528], target = "A_image_from_a_especific_region78.png")
#c(800, 128, 1400, 128)
#writePNG(equalized_matrix[800:928, 1400:1528], target = "A_image_from_a_especific_region79.png")
#c(850, 128, 1400, 128)
#writePNG(equalized_matrix[850:978, 1400:1528], target = "A_image_from_a_especific_region80.png")

#c(250, 128, 1, 128)
#writePNG(equalized_matrix[250:378, 1:128], target = "A_image_from_a_especific_region11.png")
#c(350, 128, 1, 128)
#writePNG(equalized_matrix[350:478, 1:128], target = "A_image_from_a_especific_region12.png")
#c(450, 128, 1, 128)
#writePNG(equalized_matrix[450:578, 1:128], target = "A_image_from_a_especific_region13.png")
#c(550, 128, 1, 128)
#writePNG(equalized_matrix[550:678, 1:128], target = "A_image_from_a_especific_region14.png")
#c(650, 128, 1, 128)
#writePNG(equalized_matrix[650:778, 1:128], target = "A_image_from_a_especific_region15.png")
#c(750, 128, 1, 128)
#writePNG(equalized_matrix[750:878, 1:128], target = "A_image_from_a_especific_region16.png")
#c(850, 128, 1, 128)
#writePNG(equalized_matrix[850:978, 1:128], target = "A_image_from_a_especific_region17.png")
#c(950, 128, 1, 128)
#writePNG(equalized_matrix[950:1078, 1:128], target = "A_image_from_a_especific_region18.png")
#c(1050, 128, 1, 128)
#writePNG(equalized_matrix[1050:1178, 1:128], target = "A_image_from_a_especific_region19.png")

#c(50, 128, 200, 128)
#writePNG(equalized_matrix[50:178, 200:328], target = "A_image_from_a_especific_region20.png")
#c(150, 128, 200, 128)
#writePNG(equalized_matrix[150:278, 200:328], target = "A_image_from_a_especific_region21.png")
#c(250, 128, 200, 128)
#writePNG(equalized_matrix[250:378, 200:328], target = "A_image_from_a_especific_region22.png")
#c(350, 128, 200, 128)
#writePNG(equalized_matrix[350:478, 200:328], target = "A_image_from_a_especific_region23.png")
#c(450, 128, 200, 128)
#writePNG(equalized_matrix[450:578, 200:328], target = "A_image_from_a_especific_region24.png")
#c(550, 128, 200, 128)
#writePNG(equalized_matrix[550:678, 200:328], target = "A_image_from_a_especific_region25.png")
#c(650, 128, 200, 128)
#writePNG(equalized_matrix[650:778, 200:328], target = "A_image_from_a_especific_region26.png")
#c(750, 128, 200, 128)
#writePNG(equalized_matrix[750:878, 200:328], target = "A_image_from_a_especific_region27.png")
#c(850, 128, 200, 128)
#writePNG(equalized_matrix[850:978, 200:328], target = "A_image_from_a_especific_region28.png")
#c(950, 128, 200, 128)
#writePNG(equalized_matrix[950:1078, 200:328], target = "A_image_from_a_especific_region29.png")
#c(1050, 128, 200, 128)
#writePNG(equalized_matrix[1050:1178, 200:328], target = "A_image_from_a_especific_region30.png")

#c(50, 128, 350, 128)
#writePNG(equalized_matrix[50:178, 350:478], target = "A_image_from_a_especific_region31.png")
#c(150, 128, 350, 128)
#writePNG(equalized_matrix[150:278, 350:478], target = "A_image_from_a_especific_region32.png")
#c(250, 128, 350, 128)
#writePNG(equalized_matrix[250:378, 350:478], target = "A_image_from_a_especific_region33.png")
#c(350, 128, 350, 128)
#writePNG(equalized_matrix[350:478, 350:478], target = "A_image_from_a_especific_region34.png")
#c(450, 128, 350, 128)
#writePNG(equalized_matrix[450:578, 350:478], target = "A_image_from_a_especific_region35.png")
#c(550, 128, 350, 128)
#writePNG(equalized_matrix[550:678, 350:478], target = "A_image_from_a_especific_region36.png")
#c(650, 128, 350, 128)
#writePNG(equalized_matrix[650:778, 350:478], target = "A_image_from_a_especific_region37.png")
#c(750, 128, 350, 128)
#writePNG(equalized_matrix[750:878, 350:478], target = "A_image_from_a_especific_region38.png")
#c(850, 128, 350, 128)
#writePNG(equalized_matrix[850:978, 350:478], target = "A_image_from_a_especific_region39.png")
#c(950, 128, 350, 128)
#writePNG(equalized_matrix[950:1078, 350:478], target = "A_image_from_a_especific_region40.png")

#c(50, 128, 550, 128)
#writePNG(equalized_matrix[50:178, 550:678], target = "A_image_from_a_especific_region41.png")
#c(150, 128, 550, 128)
#writePNG(equalized_matrix[150:278, 550:678], target = "A_image_from_a_especific_region42.png")
#c(250, 128, 550, 128)
#writePNG(equalized_matrix[250:378, 550:678], target = "A_image_from_a_especific_region43.png")
#c(350, 128, 550, 128)
#writePNG(equalized_matrix[350:478, 550:678], target = "A_image_from_a_especific_region44.png")
#c(450, 128, 550, 128)
#writePNG(equalized_matrix[450:578, 550:678], target = "A_image_from_a_especific_region45.png")
#c(550, 128, 550, 128)
#writePNG(equalized_matrix[550:678, 550:678], target = "A_image_from_a_especific_region46.png")
#c(650, 128, 550, 128)
#writePNG(equalized_matrix[650:778, 550:678], target = "A_image_from_a_especific_region47.png")
#c(750, 128, 550, 128)
#writePNG(equalized_matrix[750:878, 550:678], target = "A_image_from_a_especific_region48.png")
#c(850, 128, 550, 128)
#writePNG(equalized_matrix[850:978, 550:678], target = "A_image_from_a_especific_region49.png")
#c(950, 128, 550, 128)
#writePNG(equalized_matrix[950:1078, 550:678], target = "A_image_from_a_especific_region50.png")

#Munich
#c(3000, 128, 400, 128)
#writePNG(equalized_matrix[3000:3128, 400:528], target = "A_image_from_a_especific_region1.png")
#c(3050, 128, 400, 128)
#writePNG(equalized_matrix[3050:3178, 400:528], target = "A_image_from_a_especific_region2.png")
#c(3100, 128, 400, 12)
#writePNG(equalized_matrix[3100:3228, 400:528], target = "A_image_from_a_especific_region3.png")
#c(3150, 128, 400, 128)
#writePNG(equalized_matrix[3150:3278, 400:528], target = "A_image_from_a_especific_region4.png")
#c(3200, 128, 400, 128)
#writePNG(equalized_matrix[3200:3328, 400:528], target = "A_image_from_a_especific_region5.png")
#c(3250, 128, 400, 128)
#writePNG(equalized_matrix[3250:3378, 400:528], target = "A_image_from_a_especific_region6.png")
#c(3300, 128, 400, 128)
#writePNG(equalized_matrix[3300:3428, 400:528], target = "A_image_from_a_especific_region7.png")
#c(3350, 128, 400, 128)
#writePNG(equalized_matrix[3350:3478, 400:528], target = "A_image_from_a_especific_region8.png")
#c(3400, 128, 400, 128)
#writePNG(equalized_matrix[3400:3528, 400:528], target = "A_image_from_a_especific_region9.png")
#c(3450, 128, 400, 128)
#writePNG(equalized_matrix[3450:3578, 400:528], target = "A_image_from_a_especific_region10.png")

#c(3500, 128, 400, 128)
#writePNG(equalized_matrix[3500:3628, 400:528], target = "A_image_from_a_especific_region11.png")
#c(3550, 128, 400, 128)
#writePNG(equalized_matrix[3550:3678, 400:528], target = "A_image_from_a_especific_region12.png")
#c(3600, 128, 400, 12)
#writePNG(equalized_matrix[3600:3728, 400:528], target = "A_image_from_a_especific_region13.png")
#c(3650, 128, 400, 128)
#writePNG(equalized_matrix[3650:3778, 400:528], target = "A_image_from_a_especific_region14.png")
#c(3700, 128, 400, 128)
#writePNG(equalized_matrix[3700:3828, 400:528], target = "A_image_from_a_especific_region15.png")
#c(3750, 128, 400, 128)
#writePNG(equalized_matrix[3750:3878, 400:528], target = "A_image_from_a_especific_region16.png")
#c(3800, 128, 400, 128)
#writePNG(equalized_matrix[3800:3928, 400:528], target = "A_image_from_a_especific_region17.png")
#c(3850, 128, 400, 128)
#writePNG(equalized_matrix[3850:3978, 400:528], target = "A_image_from_a_especific_region18.png")
#c(3900, 128, 400, 128)
#writePNG(equalized_matrix[3900:4028, 400:528], target = "A_image_from_a_especific_region19.png")
#c(3950, 128, 400, 128)
#writePNG(equalized_matrix[3950:4078, 400:528], target = "A_image_from_a_especific_region20.png")

#c(4300, 128, 1500, 128)
#writePNG(equalized_matrix[4300:4428, 1500:1628], target = "A_image_from_a_especific_region21.png")
#c(4350, 128, 1500, 128)
#writePNG(equalized_matrix[4350:4478, 1500:1628], target = "A_image_from_a_especific_region22.png")
#c(4300, 128, 1450, 128)
#writePNG(equalized_matrix[4300:4428, 1450:1578], target = "A_image_from_a_especific_region23.png")
#c(4350, 128, 1450, 128)
#writePNG(equalized_matrix[4350:4478, 1450:1578], target = "A_image_from_a_especific_region24.png")
#c(4300, 128, 1400, 128)
#writePNG(equalized_matrix[4300:4428, 1400:1528], target = "A_image_from_a_especific_region25.png")
#c(4350, 128, 1400, 128)
#writePNG(equalized_matrix[4350:4478, 1400:1528], target = "A_image_from_a_especific_region26.png")
#c(4300, 128, 1300, 128)
#writePNG(equalized_matrix[4300:4428, 1300:1428], target = "A_image_from_a_especific_region27.png")
#c(4350, 128, 1300, 128)
#writePNG(equalized_matrix[4350:4478, 1300:1428], target = "A_image_from_a_especific_region28.png")
#c(4300, 128, 1350, 128)
#writePNG(equalized_matrix[4300:4428, 1350:1478], target = "A_image_from_a_especific_region29.png")
#c(4350, 128, 1350, 128)
#writePNG(equalized_matrix[4350:4478, 1350:1478], target = "A_image_from_a_especific_region30.png")

#c(2300, 128, 500, 128)
#writePNG(equalized_matrix[2300:2428, 500:628], target = "A_image_from_a_especific_region31.png")
#c(2350, 128, 500, 128)
#writePNG(equalized_matrix[2350:2478, 500:628], target = "A_image_from_a_especific_region32.png")
#c(2400, 128, 500, 128)
#writePNG(equalized_matrix[2400:2528, 500:628], target = "A_image_from_a_especific_region33.png")
#c(2450, 128, 500, 128)
#writePNG(equalized_matrix[2450:2578, 500:628], target = "A_image_from_a_especific_region34.png")
#c(2300, 128, 400, 128)
#writePNG(equalized_matrix[2300:2428, 400:528], target = "A_image_from_a_especific_region35.png")
#c(2350, 128, 400, 128)
#writePNG(equalized_matrix[2350:2478, 400:528], target = "A_image_from_a_especific_region36.png")
#c(2400, 128, 400, 128)
#writePNG(equalized_matrix[2400:2528, 400:528], target = "A_image_from_a_especific_region37.png")
#c(2450, 128, 400, 128)
#writePNG(equalized_matrix[2450:2578, 400:528], target = "A_image_from_a_especific_region38.png")
#c(2400, 128, 300, 128)
#writePNG(equalized_matrix[2400:2528, 300:428], target = "A_image_from_a_especific_region39.png")
#c(2450, 128, 300, 128)
#writePNG(equalized_matrix[2450:2578, 300:428], target = "A_image_from_a_especific_region40.png")

#Guatemala
#c(5150, 128, 2700, 128)
#writePNG(equalized_matrix[5150:5278, 2700:2828], target = "A_image_Test1.png")
#c(5200, 128, 2700, 128)
#writePNG(equalized_matrix[5200:5328, 2700:2828], target = "A_image_Test2.png")
#c(5250, 128, 2700, 128)
#writePNG(equalized_matrix[5250:5378, 2700:2828], target = "A_image_Test3.png")
#c(5300, 128, 2700, 128)
#writePNG(equalized_matrix[5300:5428, 2700:2828], target = "A_image_Test4.png")
#c(5350, 128, 2700, 128)
#writePNG(equalized_matrix[5350:5478, 2700:2828], target = "A_image_Test5.png")
#c(5400, 128, 2700, 128)
#writePNG(equalized_matrix[5400:5528, 2700:2828], target = "A_image_Test6.png")
#c(5450, 128, 2700, 128)
#writePNG(equalized_matrix[5450:5578, 2700:2828], target = "A_image_Test7.png")
#c(5500, 128, 2700, 128)
#writePNG(equalized_matrix[5500:5628, 2700:2828], target = "A_image_Test8.png")
#c(5550, 128, 2700, 128)
#writePNG(equalized_matrix[5550:5678, 2700:2828], target = "A_image_Test9.png")
#c(5600, 128, 2700, 128)
#writePNG(equalized_matrix[5600:5728, 2700:2828], target = "A_image_Test10.png")
#c(5650, 128, 2700, 128)
#writePNG(equalized_matrix[5650:5778, 2700:2828], target = "A_image_Test11.png")
#c(5700, 128, 2700, 128)
#writePNG(equalized_matrix[5700:5828, 2700:2828], target = "A_image_Test12.png")
#c(5750, 128, 2700, 128)
#writePNG(equalized_matrix[5750:5878, 2700:2828], target = "A_image_Test13.png")
#c(5800, 128, 2700, 128)
#writePNG(equalized_matrix[5800:5928, 2700:2828], target = "A_image_Test14.png")
#c(5850, 128, 2700, 128)
#writePNG(equalized_matrix[5850:5978, 2700:2828], target = "A_image_Test15.png")
#c(5900, 128, 2700, 128)
#writePNG(equalized_matrix[5900:6028, 2700:2828], target = "A_image_Test16.png")
#c(5950, 128, 2700, 128)
#writePNG(equalized_matrix[5950:6078, 2700:2828], target = "A_image_Test17.png")
#c(6000, 128, 2700, 128)
#writePNG(equalized_matrix[6000:6128, 2700:2828], target = "A_image_Test18.png")
#c(6050, 128, 2700, 128)
#writePNG(equalized_matrix[6050:6178, 2700:2828], target = "A_image_Test19.png")
#c(6100, 128, 2700, 128)
#writePNG(equalized_matrix[6100:6228, 2700:2828], target = "A_image_Test20.png")

#c(5200, 128, 2800, 128)
#writePNG(equalized_matrix[5200:5328, 2800:2928], target = "A_image_Test21.png")
#c(5250, 128, 2800, 128)
#writePNG(equalized_matrix[5250:5378, 2800:2928], target = "A_image_Test22.png")
#c(5300, 128, 2800, 128)
#writePNG(equalized_matrix[5300:5428, 2800:2928], target = "A_image_Test23.png")
#c(5350, 128, 2800, 128)
#writePNG(equalized_matrix[5350:5478, 2800:2928], target = "A_image_Test24.png")
#c(5400, 128, 2800, 128)
#writePNG(equalized_matrix[5400:5528, 2800:2928], target = "A_image_Test25.png")
#c(5450, 128, 2800, 128)
#writePNG(equalized_matrix[5450:5578, 2800:2928], target = "A_image_Test26.png")
#c(5500, 128, 2800, 128)
#writePNG(equalized_matrix[5500:5628, 2800:2928], target = "A_image_Test27.png")
#c(5550, 128, 2800, 128)
#writePNG(equalized_matrix[5550:5678, 2800:2928], target = "A_image_Test28.png")
#c(5600, 128, 2800, 128)
#writePNG(equalized_matrix[5600:5728, 2800:2928], target = "A_image_Test29.png")
#c(5650, 128, 2800, 128)
#writePNG(equalized_matrix[5650:5778, 2800:2928], target = "A_image_Test30.png")


#c(4100, 128, 2930, 128) 
#writePNG(equalized_matrix[4100:4228, 2930:3058], target = "A_image_Test31.png")
#c(4150, 128, 2930, 128)
#writePNG(equalized_matrix[4150:4278, 2930:3058], target = "A_image_Test32.png")
#c(4200, 128, 2930, 128) 
#writePNG(equalized_matrix[4200:4328, 2930:3058], target = "A_image_Test33.png")
#c(1000, 128, 1930, 128) 
#writePNG(equalized_matrix[1000:1128, 1930:2058], target = "A_image_Test34.png")
#c(1050, 128, 1930, 128) 
#writePNG(equalized_matrix[1050:1178, 1930:2058], target = "A_image_Test35.png")
#c(1100, 128, 1930, 128) 
#writePNG(equalized_matrix[1100:1228, 1930:2058], target = "A_image_Test36.png")
#c(1150, 128, 1930, 128) 
#writePNG(equalized_matrix[1150:1278, 1930:2058], target = "A_image_Test37.png")
#c(1000, 128, 1870, 128) 
#writePNG(equalized_matrix[1000:1128, 1870:1998], target = "A_image_Test38.png")
#c(1050, 128, 1870, 128) 
#writePNG(equalized_matrix[1050:1178, 1870:1998], target = "A_image_Test39.png")
#c(1100, 128, 1870, 128) 
#writePNG(equalized_matrix[1100:1228, 1870:1998], target = "A_image_Test40.png")

#writePNG(equalized_matrix[250:378, 1100:1228], target = "A_image_Test.png")
#writePNG(equalized_matrix[250:378, 1850:1978], target = "A_image_Test.png")
#writePNG(equalized_matrix[1675:1803, 1930:2058], target = "A_image_Test.png")

rm(equalized_matrix)