z <- OneDimensionTextureHilbert(img)
distz <- fitdistr(z, "gamma")
z <- data.frame(z)
binwidth_complete <- 2*IQR(z$z)*length(z$z)^(-1/3)
ggplot(data=data.frame(z), aes(x=z)) + geom_histogram(aes(y=..density..), binwidth = binwidth_complete) + stat_function(fun=dgamma, args = list(shape=2.07384986, rate=24.40283197))
##############################################Análise completa###########################################
ns = 40
ns.guatemala = 40
dimen.guatemala <- matrix(nrow = ns.guatemala, ncol = 4)
ns.canaveral.behavior1 = 40
dimen.canaveral.behavior1 <- matrix(nrow = ns.canaveral.behavior1, ncol = 4)
ns.canaveral.behavior2 = 40
dimen.canaveral.behavior2 <- matrix(nrow = ns.canaveral.behavior2, ncol = 4)
ns.munich = 40
dimen.munich <- matrix(nrow = ns.munich, ncol = 4)
#Ocean regions in Cape Canaveral
row1 <- c(50, 100, 150, 200, 250, 350, 450, 550, 650, 750)
row2 <- c(50, 100, 150, 200, 250, 300, 350, 400, 450, 550)
row3 <- c(50, 150, 250, 350, 450, 550, 650, 750, 800, 850)
row4 <- c(250, 350, 450, 550, 650, 750, 850, 950, 1050)
row5 <- c(50, 150, 250, 350, 450, 550, 650, 750, 850, 950, 1050)
row6 <- c(50, 150, 250, 350, 450, 550, 650, 750, 800, 850, 950)
row7 <- c(50, 150, 250, 350, 450, 550, 650, 750, 850, 950)
cols <- c(1700, 1850, 1550, 1400, 1, 200, 350, 550)
#{Behavior 1}
dimen.canaveral.behavior1[1:10,] <- c(row1, rep(128, 10), rep(cols[1], 10), rep(128, 10))
dimen.canaveral.behavior1[11:20,] <- c(row2, rep(128, 10), rep(cols[2], 10), rep(128, 10))
dimen.canaveral.behavior1[21:30,] <- c(row3, rep(128, 10), rep(cols[3], 10), rep(128, 10))
dimen.canaveral.behavior1[31:40,] <- c(row3, rep(128, 10), rep(cols[4], 10), rep(128, 10))
#{Behavior 2}
dimen.canaveral.behavior2[1:9,] <- c(row4, rep(128, 9), rep(cols[5], 9), rep(128, 9))
dimen.canaveral.behavior2[10:20,] <- c(row5, rep(128, 11), rep(cols[6], 11), rep(128, 11))
dimen.canaveral.behavior2[21:30,] <- c(row7, rep(128, 10), rep(cols[7], 10), rep(128, 10))
dimen.canaveral.behavior2[31:40,] <- c(row7, rep(128, 10), rep(cols[8], 10), rep(128, 10))
#Urban regions in Munich
row1 <- seq(3000, 3950, by = 50)
row2 <- rep(c(4300, 4350), 5)
row3 <- c(rep(seq(2300, 2450, by = 50), 2), 2400, 2450)
cols <- 400
cols2 <- c(1300, 1300, 1350, 1350, 1400, 1400, 1450, 1450, 1500, 1500)
cols3 <- c(rep(500, 4), rep(400, 4), rep(300, 2))
dimen.munich[1:20,] <- c(row1, rep(128, 20), rep(cols, 20), rep(128, 20))
dimen.munich[21:30,] <- c(row2, rep(128, 10), cols2, rep(128, 10))
dimen.munich[31:40,] <- c(row3, rep(128, 10), cols3, rep(128, 10))
#Forest regions in Guatemala
row1 <- seq(5150, 6100, by = 50)
row2 <- seq(5200, 5650, by = 50)
row3 <- seq(4100, 4200, by = 50)
row4 <- seq(1000, 1150, by = 50)
cols <- c(2700, 2800, 2930, 1930, 1870)
dimen.guatemala[1:20,] <- c(row1, rep(128, 20), rep(cols[1], 20), rep(128, 20))
dimen.guatemala[21:30,] <- c(row2, rep(128, 10), rep(cols[2], 10), rep(128, 10))
dimen.guatemala[31:33,] <- c(row3, rep(128, 3), rep(cols[3], 3), rep(128, 3))
dimen.guatemala[34:37,] <- c(row4, rep(128, 4), rep(cols[4], 4), rep(128, 4))
dimen.guatemala[38:40,] <- c(row4[1:3], rep(128, 3), rep(cols[5], 3), rep(128, 3))
SAR.Analysis.Regions <- function(option){
gamma.parameters = array(list(), ns)
gamma.results <- data.frame(Estimate.shape = numeric(0), Estimate.rate = numeric(0), Sd.shape = numeric(0), Sd.rate = numeric(0))
if(option == 1){ #Forest regions in Guatemala
sar_data <- raster(paste("../../Data/", "guatemala", "/HHHH", ".grd", sep = ""))
for(j in c(1:ns.guatemala)){
img <- getValuesBlock(sar_data, row = dimen.guatemala[j,1], nrows = dimen.guatemala[j,2], col = dimen.guatemala[j,3], ncols = dimen.guatemala[j,4], format = "matrix")
z <- OneDimensionTextureHilbert(img)
gamma.parameters[[j]] <- fitdistr(z, "gamma")
gamma.results[j,] = c(unlist(gamma.parameters[[j]])[1], unlist(gamma.parameters[[j]])[2], unlist(gamma.parameters[[j]])[3], unlist(gamma.parameters[[j]])[4])
}
}
else if(option == 2){ #Cape Canaveral - behavior 1
sar_data <- raster(paste("../../Data/", "cape", "/HHHH", ".grd", sep = ""))
for(j in c(1:ns.canaveral.behavior1)){
img <- getValuesBlock(sar_data, row = dimen.canaveral.behavior1[j,1], nrows = dimen.canaveral.behavior1[j,2], col = dimen.canaveral.behavior1[j,3], ncols = dimen.canaveral.behavior1[j,4], format = "matrix")
z <- OneDimensionTextureHilbert(img)
gamma.parameters[[j]] <- fitdistr(z, "gamma")
gamma.results[j,] = c(unlist(gamma.parameters[[j]])[1], unlist(gamma.parameters[[j]])[2], unlist(gamma.parameters[[j]])[3], unlist(gamma.parameters[[j]])[4])
}
}
else if(option == 3){ #Cape Canaveral - behavior 2
sar_data <- raster(paste("../../Data/", "cape", "/HHHH", ".grd", sep = ""))
for(j in c(1:ns.canaveral.behavior2)){
img <- getValuesBlock(sar_data, row = dimen.canaveral.behavior2[j,1], nrows = dimen.canaveral.behavior2[j,2], col = dimen.canaveral.behavior2[j,3], ncols = dimen.canaveral.behavior2[j,4], format = "matrix")
z <- OneDimensionTextureHilbert(img)
gamma.parameters[[j]] <- fitdistr(z, "gamma")
gamma.results[j,] = c(unlist(gamma.parameters[[j]])[1], unlist(gamma.parameters[[j]])[2], unlist(gamma.parameters[[j]])[3], unlist(gamma.parameters[[j]])[4])
}
}
else{ #Urban regions in Munich
sar_data <- raster(paste("../../Data/", "munich", "/HHHH", ".grd", sep = ""))
for(j in c(1:ns.munich)){
img <- getValuesBlock(sar_data, row = dimen.munich[j,1], nrows = dimen.munich[j,2], col = dimen.munich[j,3], ncols = dimen.munich[j,4], format = "matrix")
z <- OneDimensionTextureHilbert(img)
gamma.parameters[[j]] <- fitdistr(z, "gamma")
gamma.results[j,] = c(unlist(gamma.parameters[[j]])[1], unlist(gamma.parameters[[j]])[2], unlist(gamma.parameters[[j]])[3], unlist(gamma.parameters[[j]])[4])
}
}
return(gamma.results)
}
gamma.guatemala <- SAR.Analysis.Regions(1)
gamma.cape1 <- SAR.Analysis.Regions(2)
gamma.cape2 <- SAR.Analysis.Regions(3)
gamma.munich <- SAR.Analysis.Regions(4)
View(gamma.cape1)
View(gamma.guatemala)
View(gamma.munich)
gamma.cape2 <- SAR.Analysis.Regions(3)
ns = 40
ns.guatemala = 40
dimen.guatemala <- matrix(nrow = ns.guatemala, ncol = 4)
ns.canaveral.behavior1 = 40
dimen.canaveral.behavior1 <- matrix(nrow = ns.canaveral.behavior1, ncol = 4)
ns.canaveral.behavior2 = 40
dimen.canaveral.behavior2 <- matrix(nrow = ns.canaveral.behavior2, ncol = 4)
ns.munich = 40
dimen.munich <- matrix(nrow = ns.munich, ncol = 4)
#Ocean regions in Cape Canaveral
row1 <- c(50, 100, 150, 200, 250, 350, 450, 550, 650, 750)
row2 <- c(50, 100, 150, 200, 250, 300, 350, 400, 450, 550)
row3 <- c(50, 150, 250, 350, 450, 550, 650, 750, 800, 850)
row4 <- c(250, 350, 450, 550, 650, 750, 850, 950, 1050)
row5 <- c(50, 150, 250, 350, 450, 550, 650, 750, 850, 950, 1050)
row6 <- c(50, 150, 250, 350, 450, 550, 650, 750, 800, 850, 950)
row7 <- c(50, 150, 250, 350, 450, 550, 650, 750, 850, 950)
cols <- c(1700, 1850, 1550, 1400, 1, 200, 350, 550)
#{Behavior 1}
dimen.canaveral.behavior1[1:10,] <- c(row1, rep(128, 10), rep(cols[1], 10), rep(128, 10))
dimen.canaveral.behavior1[11:20,] <- c(row2, rep(128, 10), rep(cols[2], 10), rep(128, 10))
dimen.canaveral.behavior1[21:30,] <- c(row3, rep(128, 10), rep(cols[3], 10), rep(128, 10))
dimen.canaveral.behavior1[31:40,] <- c(row3, rep(128, 10), rep(cols[4], 10), rep(128, 10))
#{Behavior 2}
dimen.canaveral.behavior2[1:9,] <- c(row4, rep(128, 9), rep(cols[5], 9), rep(128, 9))
dimen.canaveral.behavior2[10:20,] <- c(row5, rep(128, 11), rep(cols[6], 11), rep(128, 11))
dimen.canaveral.behavior2[21:30,] <- c(row7, rep(128, 10), rep(cols[7], 10), rep(128, 10))
dimen.canaveral.behavior2[31:40,] <- c(row7, rep(128, 10), rep(cols[8], 10), rep(128, 10))
#Urban regions in Munich
row1 <- seq(3000, 3950, by = 50)
row2 <- rep(c(4300, 4350), 5)
row3 <- c(rep(seq(2300, 2450, by = 50), 2), 2400, 2450)
cols <- 400
cols2 <- c(1300, 1300, 1350, 1350, 1400, 1400, 1450, 1450, 1500, 1500)
cols3 <- c(rep(500, 4), rep(400, 4), rep(300, 2))
dimen.munich[1:20,] <- c(row1, rep(128, 20), rep(cols, 20), rep(128, 20))
dimen.munich[21:30,] <- c(row2, rep(128, 10), cols2, rep(128, 10))
dimen.munich[31:40,] <- c(row3, rep(128, 10), cols3, rep(128, 10))
#Forest regions in Guatemala
row1 <- seq(5150, 6100, by = 50)
row2 <- seq(5200, 5650, by = 50)
row3 <- seq(4100, 4200, by = 50)
row4 <- seq(1000, 1150, by = 50)
cols <- c(2700, 2800, 2930, 1930, 1870)
dimen.guatemala[1:20,] <- c(row1, rep(128, 20), rep(cols[1], 20), rep(128, 20))
dimen.guatemala[21:30,] <- c(row2, rep(128, 10), rep(cols[2], 10), rep(128, 10))
dimen.guatemala[31:33,] <- c(row3, rep(128, 3), rep(cols[3], 3), rep(128, 3))
dimen.guatemala[34:37,] <- c(row4, rep(128, 4), rep(cols[4], 4), rep(128, 4))
dimen.guatemala[38:40,] <- c(row4[1:3], rep(128, 3), rep(cols[5], 3), rep(128, 3))
SAR.Analysis.Regions <- function(option){
gamma.parameters = array(list(), ns)
gamma.results <- data.frame(Estimate.shape = numeric(0), Estimate.rate = numeric(0), Sd.shape = numeric(0), Sd.rate = numeric(0))
if(option == 1){ #Forest regions in Guatemala
sar_data <- raster(paste("../../Data/", "guatemala", "/HHHH", ".grd", sep = ""))
for(j in c(1:ns.guatemala)){
img <- getValuesBlock(sar_data, row = dimen.guatemala[j,1], nrows = dimen.guatemala[j,2], col = dimen.guatemala[j,3], ncols = dimen.guatemala[j,4], format = "matrix")
z <- OneDimensionTextureHilbert(img)
gamma.parameters[[j]] <- fitdistr(z, "gamma")
gamma.results[j,] = c(unlist(gamma.parameters[[j]])[1], unlist(gamma.parameters[[j]])[2], unlist(gamma.parameters[[j]])[3], unlist(gamma.parameters[[j]])[4])
}
}
else if(option == 2){ #Cape Canaveral - behavior 1
sar_data <- raster(paste("../../Data/", "cape", "/HHHH", ".grd", sep = ""))
for(j in c(1:ns.canaveral.behavior1)){
img <- getValuesBlock(sar_data, row = dimen.canaveral.behavior1[j,1], nrows = dimen.canaveral.behavior1[j,2], col = dimen.canaveral.behavior1[j,3], ncols = dimen.canaveral.behavior1[j,4], format = "matrix")
z <- OneDimensionTextureHilbert(img)
gamma.parameters[[j]] <- fitdistr(z, "gamma")
gamma.results[j,] = c(unlist(gamma.parameters[[j]])[1], unlist(gamma.parameters[[j]])[2], unlist(gamma.parameters[[j]])[3], unlist(gamma.parameters[[j]])[4])
}
}
else if(option == 3){ #Cape Canaveral - behavior 2
sar_data <- raster(paste("../../Data/", "cape", "/HHHH", ".grd", sep = ""))
for(j in c(1:ns.canaveral.behavior2)){
img <- getValuesBlock(sar_data, row = dimen.canaveral.behavior2[j,1], nrows = dimen.canaveral.behavior2[j,2], col = dimen.canaveral.behavior2[j,3], ncols = dimen.canaveral.behavior2[j,4], format = "matrix")
z <- OneDimensionTextureHilbert(img)
return(data.frame(z))
gamma.parameters[[j]] <- fitdistr(z, "gamma")
gamma.results[j,] = c(unlist(gamma.parameters[[j]])[1], unlist(gamma.parameters[[j]])[2], unlist(gamma.parameters[[j]])[3], unlist(gamma.parameters[[j]])[4])
}
}
else{ #Urban regions in Munich
sar_data <- raster(paste("../../Data/", "munich", "/HHHH", ".grd", sep = ""))
for(j in c(1:ns.munich)){
img <- getValuesBlock(sar_data, row = dimen.munich[j,1], nrows = dimen.munich[j,2], col = dimen.munich[j,3], ncols = dimen.munich[j,4], format = "matrix")
z <- OneDimensionTextureHilbert(img)
gamma.parameters[[j]] <- fitdistr(z, "gamma")
gamma.results[j,] = c(unlist(gamma.parameters[[j]])[1], unlist(gamma.parameters[[j]])[2], unlist(gamma.parameters[[j]])[3], unlist(gamma.parameters[[j]])[4])
}
}
return(gamma.results)
}
gamma.cape2 <- SAR.Analysis.Regions(3)
View(gamma.cape2)
ns = 40
ns.guatemala = 40
dimen.guatemala <- matrix(nrow = ns.guatemala, ncol = 4)
ns.canaveral.behavior1 = 40
dimen.canaveral.behavior1 <- matrix(nrow = ns.canaveral.behavior1, ncol = 4)
ns.canaveral.behavior2 = 40
dimen.canaveral.behavior2 <- matrix(nrow = ns.canaveral.behavior2, ncol = 4)
ns.munich = 40
dimen.munich <- matrix(nrow = ns.munich, ncol = 4)
#Ocean regions in Cape Canaveral
row1 <- c(50, 100, 150, 200, 250, 350, 450, 550, 650, 750)
row2 <- c(50, 100, 150, 200, 250, 300, 350, 400, 450, 550)
row3 <- c(50, 150, 250, 350, 450, 550, 650, 750, 800, 850)
row4 <- c(250, 350, 450, 550, 650, 750, 850, 950, 1050)
row5 <- c(50, 150, 250, 350, 450, 550, 650, 750, 850, 950, 1050)
row6 <- c(50, 150, 250, 350, 450, 550, 650, 750, 800, 850, 950)
row7 <- c(50, 150, 250, 350, 450, 550, 650, 750, 850, 950)
cols <- c(1700, 1850, 1550, 1400, 1, 200, 350, 550)
#{Behavior 1}
dimen.canaveral.behavior1[1:10,] <- c(row1, rep(128, 10), rep(cols[1], 10), rep(128, 10))
dimen.canaveral.behavior1[11:20,] <- c(row2, rep(128, 10), rep(cols[2], 10), rep(128, 10))
dimen.canaveral.behavior1[21:30,] <- c(row3, rep(128, 10), rep(cols[3], 10), rep(128, 10))
dimen.canaveral.behavior1[31:40,] <- c(row3, rep(128, 10), rep(cols[4], 10), rep(128, 10))
#{Behavior 2}
dimen.canaveral.behavior2[1:9,] <- c(row4, rep(128, 9), rep(cols[5], 9), rep(128, 9))
dimen.canaveral.behavior2[10:20,] <- c(row5, rep(128, 11), rep(cols[6], 11), rep(128, 11))
dimen.canaveral.behavior2[21:30,] <- c(row7, rep(128, 10), rep(cols[7], 10), rep(128, 10))
dimen.canaveral.behavior2[31:40,] <- c(row7, rep(128, 10), rep(cols[8], 10), rep(128, 10))
#Urban regions in Munich
row1 <- seq(3000, 3950, by = 50)
row2 <- rep(c(4300, 4350), 5)
row3 <- c(rep(seq(2300, 2450, by = 50), 2), 2400, 2450)
cols <- 400
cols2 <- c(1300, 1300, 1350, 1350, 1400, 1400, 1450, 1450, 1500, 1500)
cols3 <- c(rep(500, 4), rep(400, 4), rep(300, 2))
dimen.munich[1:20,] <- c(row1, rep(128, 20), rep(cols, 20), rep(128, 20))
dimen.munich[21:30,] <- c(row2, rep(128, 10), cols2, rep(128, 10))
dimen.munich[31:40,] <- c(row3, rep(128, 10), cols3, rep(128, 10))
#Forest regions in Guatemala
row1 <- seq(5150, 6100, by = 50)
row2 <- seq(5200, 5650, by = 50)
row3 <- seq(4100, 4200, by = 50)
row4 <- seq(1000, 1150, by = 50)
cols <- c(2700, 2800, 2930, 1930, 1870)
dimen.guatemala[1:20,] <- c(row1, rep(128, 20), rep(cols[1], 20), rep(128, 20))
dimen.guatemala[21:30,] <- c(row2, rep(128, 10), rep(cols[2], 10), rep(128, 10))
dimen.guatemala[31:33,] <- c(row3, rep(128, 3), rep(cols[3], 3), rep(128, 3))
dimen.guatemala[34:37,] <- c(row4, rep(128, 4), rep(cols[4], 4), rep(128, 4))
dimen.guatemala[38:40,] <- c(row4[1:3], rep(128, 3), rep(cols[5], 3), rep(128, 3))
SAR.Analysis.Regions <- function(option){
gamma.parameters = array(list(), ns)
gamma.results <- data.frame(Estimate.shape = numeric(0), Estimate.rate = numeric(0), Sd.shape = numeric(0), Sd.rate = numeric(0))
if(option == 1){ #Forest regions in Guatemala
sar_data <- raster(paste("../../Data/", "guatemala", "/HHHH", ".grd", sep = ""))
for(j in c(1:ns.guatemala)){
img <- getValuesBlock(sar_data, row = dimen.guatemala[j,1], nrows = dimen.guatemala[j,2], col = dimen.guatemala[j,3], ncols = dimen.guatemala[j,4], format = "matrix")
z <- OneDimensionTextureHilbert(img)
gamma.parameters[[j]] <- fitdistr(z, "gamma")
gamma.results[j,] = c(unlist(gamma.parameters[[j]])[1], unlist(gamma.parameters[[j]])[2], unlist(gamma.parameters[[j]])[3], unlist(gamma.parameters[[j]])[4])
}
}
else if(option == 2){ #Cape Canaveral - behavior 1
sar_data <- raster(paste("../../Data/", "cape", "/HHHH", ".grd", sep = ""))
for(j in c(1:ns.canaveral.behavior1)){
img <- getValuesBlock(sar_data, row = dimen.canaveral.behavior1[j,1], nrows = dimen.canaveral.behavior1[j,2], col = dimen.canaveral.behavior1[j,3], ncols = dimen.canaveral.behavior1[j,4], format = "matrix")
z <- OneDimensionTextureHilbert(img)
gamma.parameters[[j]] <- fitdistr(z, "gamma")
gamma.results[j,] = c(unlist(gamma.parameters[[j]])[1], unlist(gamma.parameters[[j]])[2], unlist(gamma.parameters[[j]])[3], unlist(gamma.parameters[[j]])[4])
}
}
else if(option == 3){ #Cape Canaveral - behavior 2
sar_data <- raster(paste("../../Data/", "cape", "/HHHH", ".grd", sep = ""))
for(j in c(1:ns.canaveral.behavior2)){
img <- getValuesBlock(sar_data, row = dimen.canaveral.behavior2[j,1], nrows = dimen.canaveral.behavior2[j,2], col = dimen.canaveral.behavior2[j,3], ncols = dimen.canaveral.behavior2[j,4], format = "matrix")
z <- OneDimensionTextureHilbert(img)
return(z)
gamma.parameters[[j]] <- fitdistr(z, "gamma")
gamma.results[j,] = c(unlist(gamma.parameters[[j]])[1], unlist(gamma.parameters[[j]])[2], unlist(gamma.parameters[[j]])[3], unlist(gamma.parameters[[j]])[4])
}
}
else{ #Urban regions in Munich
sar_data <- raster(paste("../../Data/", "munich", "/HHHH", ".grd", sep = ""))
for(j in c(1:ns.munich)){
img <- getValuesBlock(sar_data, row = dimen.munich[j,1], nrows = dimen.munich[j,2], col = dimen.munich[j,3], ncols = dimen.munich[j,4], format = "matrix")
z <- OneDimensionTextureHilbert(img)
gamma.parameters[[j]] <- fitdistr(z, "gamma")
gamma.results[j,] = c(unlist(gamma.parameters[[j]])[1], unlist(gamma.parameters[[j]])[2], unlist(gamma.parameters[[j]])[3], unlist(gamma.parameters[[j]])[4])
}
}
return(gamma.results)
}
gamma.cape2 <- SAR.Analysis.Regions(3)
fitdistr(gamma.cape2, "gamma")
?fitdistr
is.infinite(gamma.cape2)
is.finite(gamma.cape2)
fitdistr(gamma.cape2, "gamma")
gamma.cape2[gamma.cape2==0]
gamma.cape2[gamma.cape2==1]
sum(gamma.cape2 == 0)
install.packages("‘lmom’")
install.packages("lmom")
require(lmom)
require(lmom)
require(lmom)
ns = 40
ns.guatemala = 40
dimen.guatemala <- matrix(nrow = ns.guatemala, ncol = 4)
ns.canaveral.behavior1 = 40
dimen.canaveral.behavior1 <- matrix(nrow = ns.canaveral.behavior1, ncol = 4)
ns.canaveral.behavior2 = 40
dimen.canaveral.behavior2 <- matrix(nrow = ns.canaveral.behavior2, ncol = 4)
ns.munich = 40
dimen.munich <- matrix(nrow = ns.munich, ncol = 4)
#Ocean regions in Cape Canaveral
row1 <- c(50, 100, 150, 200, 250, 350, 450, 550, 650, 750)
row2 <- c(50, 100, 150, 200, 250, 300, 350, 400, 450, 550)
row3 <- c(50, 150, 250, 350, 450, 550, 650, 750, 800, 850)
row4 <- c(250, 350, 450, 550, 650, 750, 850, 950, 1050)
row5 <- c(50, 150, 250, 350, 450, 550, 650, 750, 850, 950, 1050)
row6 <- c(50, 150, 250, 350, 450, 550, 650, 750, 800, 850, 950)
row7 <- c(50, 150, 250, 350, 450, 550, 650, 750, 850, 950)
cols <- c(1700, 1850, 1550, 1400, 1, 200, 350, 550)
#{Behavior 1}
dimen.canaveral.behavior1[1:10,] <- c(row1, rep(128, 10), rep(cols[1], 10), rep(128, 10))
dimen.canaveral.behavior1[11:20,] <- c(row2, rep(128, 10), rep(cols[2], 10), rep(128, 10))
dimen.canaveral.behavior1[21:30,] <- c(row3, rep(128, 10), rep(cols[3], 10), rep(128, 10))
dimen.canaveral.behavior1[31:40,] <- c(row3, rep(128, 10), rep(cols[4], 10), rep(128, 10))
#{Behavior 2}
dimen.canaveral.behavior2[1:9,] <- c(row4, rep(128, 9), rep(cols[5], 9), rep(128, 9))
dimen.canaveral.behavior2[10:20,] <- c(row5, rep(128, 11), rep(cols[6], 11), rep(128, 11))
dimen.canaveral.behavior2[21:30,] <- c(row7, rep(128, 10), rep(cols[7], 10), rep(128, 10))
dimen.canaveral.behavior2[31:40,] <- c(row7, rep(128, 10), rep(cols[8], 10), rep(128, 10))
#Urban regions in Munich
row1 <- seq(3000, 3950, by = 50)
row2 <- rep(c(4300, 4350), 5)
row3 <- c(rep(seq(2300, 2450, by = 50), 2), 2400, 2450)
cols <- 400
cols2 <- c(1300, 1300, 1350, 1350, 1400, 1400, 1450, 1450, 1500, 1500)
cols3 <- c(rep(500, 4), rep(400, 4), rep(300, 2))
dimen.munich[1:20,] <- c(row1, rep(128, 20), rep(cols, 20), rep(128, 20))
dimen.munich[21:30,] <- c(row2, rep(128, 10), cols2, rep(128, 10))
dimen.munich[31:40,] <- c(row3, rep(128, 10), cols3, rep(128, 10))
#Forest regions in Guatemala
row1 <- seq(5150, 6100, by = 50)
row2 <- seq(5200, 5650, by = 50)
row3 <- seq(4100, 4200, by = 50)
row4 <- seq(1000, 1150, by = 50)
cols <- c(2700, 2800, 2930, 1930, 1870)
dimen.guatemala[1:20,] <- c(row1, rep(128, 20), rep(cols[1], 20), rep(128, 20))
dimen.guatemala[21:30,] <- c(row2, rep(128, 10), rep(cols[2], 10), rep(128, 10))
dimen.guatemala[31:33,] <- c(row3, rep(128, 3), rep(cols[3], 3), rep(128, 3))
dimen.guatemala[34:37,] <- c(row4, rep(128, 4), rep(cols[4], 4), rep(128, 4))
dimen.guatemala[38:40,] <- c(row4[1:3], rep(128, 3), rep(cols[5], 3), rep(128, 3))
SAR.Analysis.Regions <- function(option){
gamma.parameters = array(list(), ns)
gamma.results <- data.frame(Estimate.shape = numeric(0), Estimate.rate = numeric(0), Sd.shape = numeric(0), Sd.rate = numeric(0))
if(option == 1){ #Forest regions in Guatemala
sar_data <- raster(paste("../../Data/", "guatemala", "/HHHH", ".grd", sep = ""))
for(j in c(1:ns.guatemala)){
img <- getValuesBlock(sar_data, row = dimen.guatemala[j,1], nrows = dimen.guatemala[j,2], col = dimen.guatemala[j,3], ncols = dimen.guatemala[j,4], format = "matrix")
z <- OneDimensionTextureHilbert(img)
gamma.parameters[[j]] <- fitdistr(z, "gamma")
gamma.results[j,] = c(unlist(gamma.parameters[[j]])[1], unlist(gamma.parameters[[j]])[2], unlist(gamma.parameters[[j]])[3], unlist(gamma.parameters[[j]])[4])
}
}
else if(option == 2){ #Cape Canaveral - behavior 1
sar_data <- raster(paste("../../Data/", "cape", "/HHHH", ".grd", sep = ""))
for(j in c(1:ns.canaveral.behavior1)){
img <- getValuesBlock(sar_data, row = dimen.canaveral.behavior1[j,1], nrows = dimen.canaveral.behavior1[j,2], col = dimen.canaveral.behavior1[j,3], ncols = dimen.canaveral.behavior1[j,4], format = "matrix")
z <- OneDimensionTextureHilbert(img)
gamma.parameters[[j]] <- fitdistr(z, "gamma")
gamma.results[j,] = c(unlist(gamma.parameters[[j]])[1], unlist(gamma.parameters[[j]])[2], unlist(gamma.parameters[[j]])[3], unlist(gamma.parameters[[j]])[4])
}
}
else if(option == 3){ #Cape Canaveral - behavior 2
sar_data <- raster(paste("../../Data/", "cape", "/HHHH", ".grd", sep = ""))
for(j in c(1:ns.canaveral.behavior2)){
img <- getValuesBlock(sar_data, row = dimen.canaveral.behavior2[j,1], nrows = dimen.canaveral.behavior2[j,2], col = dimen.canaveral.behavior2[j,3], ncols = dimen.canaveral.behavior2[j,4], format = "matrix")
z <- OneDimensionTextureHilbert(img)
print(sum(gamma.cape2 == 0))
gamma.parameters[[j]] <- pelgam(z)
return(gamma.parameters[[j]])
#gamma.results[j,] = c(unlist(gamma.parameters[[j]])[1], unlist(gamma.parameters[[j]])[2], unlist(gamma.parameters[[j]])[3], unlist(gamma.parameters[[j]])[4])
}
}
else{ #Urban regions in Munich
sar_data <- raster(paste("../../Data/", "munich", "/HHHH", ".grd", sep = ""))
for(j in c(1:ns.munich)){
img <- getValuesBlock(sar_data, row = dimen.munich[j,1], nrows = dimen.munich[j,2], col = dimen.munich[j,3], ncols = dimen.munich[j,4], format = "matrix")
z <- OneDimensionTextureHilbert(img)
gamma.parameters[[j]] <- fitdistr(z, "gamma")
gamma.results[j,] = c(unlist(gamma.parameters[[j]])[1], unlist(gamma.parameters[[j]])[2], unlist(gamma.parameters[[j]])[3], unlist(gamma.parameters[[j]])[4])
}
}
return(gamma.results)
}
gamma.cape2 <- SAR.Analysis.Regions(3)
View(gamma.cape1)
########################################################################################################
# GammaEstimator.R
#
#
#
# Author: Eduarda Chagas
# Date : Aug 2019
# Contact: eduarda-chagas@ufmg.br
########################################################################################################
############################################# Packages #################################################
source("../SAR/SARTimeSerie.R")
source("../Textures/TextureTimeSeries.R")
source("../Band&Pompe.R")
source("imagematrix.R")
require(maxLik)
require(stats4)
require(ggplot2)
require(ggpubr)
require(reshape2)
require(MASS)
require(lmom)
###################################### Image Sample Parameters ##########################################
ns = 40
ns.guatemala = 40
dimen.guatemala <- matrix(nrow = ns.guatemala, ncol = 4)
ns.canaveral.behavior1 = 40
dimen.canaveral.behavior1 <- matrix(nrow = ns.canaveral.behavior1, ncol = 4)
ns.canaveral.behavior2 = 40
dimen.canaveral.behavior2 <- matrix(nrow = ns.canaveral.behavior2, ncol = 4)
ns.munich = 40
dimen.munich <- matrix(nrow = ns.munich, ncol = 4)
#Ocean regions in Cape Canaveral
row1 <- c(50, 100, 150, 200, 250, 350, 450, 550, 650, 750)
row2 <- c(50, 100, 150, 200, 250, 300, 350, 400, 450, 550)
row3 <- c(50, 150, 250, 350, 450, 550, 650, 750, 800, 850)
row4 <- c(250, 350, 450, 550, 650, 750, 850, 950, 1050)
row5 <- c(50, 150, 250, 350, 450, 550, 650, 750, 850, 950, 1050)
row6 <- c(50, 150, 250, 350, 450, 550, 650, 750, 800, 850, 950)
row7 <- c(50, 150, 250, 350, 450, 550, 650, 750, 850, 950)
cols <- c(1700, 1850, 1550, 1400, 1, 200, 350, 550)
#{Behavior 1}
dimen.canaveral.behavior1[1:10,] <- c(row1, rep(128, 10), rep(cols[1], 10), rep(128, 10))
dimen.canaveral.behavior1[11:20,] <- c(row2, rep(128, 10), rep(cols[2], 10), rep(128, 10))
dimen.canaveral.behavior1[21:30,] <- c(row3, rep(128, 10), rep(cols[3], 10), rep(128, 10))
dimen.canaveral.behavior1[31:40,] <- c(row3, rep(128, 10), rep(cols[4], 10), rep(128, 10))
#{Behavior 2}
dimen.canaveral.behavior2[1:9,] <- c(row4, rep(128, 9), rep(cols[5], 9), rep(128, 9))
dimen.canaveral.behavior2[10:20,] <- c(row5, rep(128, 11), rep(cols[6], 11), rep(128, 11))
dimen.canaveral.behavior2[21:30,] <- c(row7, rep(128, 10), rep(cols[7], 10), rep(128, 10))
dimen.canaveral.behavior2[31:40,] <- c(row7, rep(128, 10), rep(cols[8], 10), rep(128, 10))
#Urban regions in Munich
row1 <- seq(3000, 3950, by = 50)
row2 <- rep(c(4300, 4350), 5)
row3 <- c(rep(seq(2300, 2450, by = 50), 2), 2400, 2450)
cols <- 400
cols2 <- c(1300, 1300, 1350, 1350, 1400, 1400, 1450, 1450, 1500, 1500)
cols3 <- c(rep(500, 4), rep(400, 4), rep(300, 2))
dimen.munich[1:20,] <- c(row1, rep(128, 20), rep(cols, 20), rep(128, 20))
dimen.munich[21:30,] <- c(row2, rep(128, 10), cols2, rep(128, 10))
dimen.munich[31:40,] <- c(row3, rep(128, 10), cols3, rep(128, 10))
#Forest regions in Guatemala
row1 <- seq(5150, 6100, by = 50)
row2 <- seq(5200, 5650, by = 50)
row3 <- seq(4100, 4200, by = 50)
row4 <- seq(1000, 1150, by = 50)
cols <- c(2700, 2800, 2930, 1930, 1870)
dimen.guatemala[1:20,] <- c(row1, rep(128, 20), rep(cols[1], 20), rep(128, 20))
dimen.guatemala[21:30,] <- c(row2, rep(128, 10), rep(cols[2], 10), rep(128, 10))
dimen.guatemala[31:33,] <- c(row3, rep(128, 3), rep(cols[3], 3), rep(128, 3))
dimen.guatemala[34:37,] <- c(row4, rep(128, 4), rep(cols[4], 4), rep(128, 4))
dimen.guatemala[38:40,] <- c(row4[1:3], rep(128, 3), rep(cols[5], 3), rep(128, 3))
###################################### Function of Analysis ##########################################
Gamma.Estimation.Regions <- function(option){
gamma.results <- data.frame(Estimate.shape = numeric(0), Estimate.rate = numeric(0), Sd.shape = numeric(0), Sd.rate = numeric(0))
if(option == 1){ #Forest regions in Guatemala
sar_data <- raster(paste("../../Data/", "guatemala", "/HHHH", ".grd", sep = ""))
for(j in c(1:ns.guatemala)){
img <- getValuesBlock(sar_data, row = dimen.guatemala[j,1], nrows = dimen.guatemala[j,2], col = dimen.guatemala[j,3], ncols = dimen.guatemala[j,4], format = "matrix")
z <- OneDimensionTextureHilbert(img)
gamma.parameters <- fitdistr(z, "gamma")
gamma.results[j,] = c(unlist(gamma.parameters)[1], unlist(gamma.parameters)[2], unlist(gamma.parameters)[3], unlist(gamma.parameters)[4])
}
}
else if(option == 2){ #Cape Canaveral - behavior 1
sar_data <- raster(paste("../../Data/", "cape", "/HHHH", ".grd", sep = ""))
for(j in c(1:ns.canaveral.behavior1)){
img <- getValuesBlock(sar_data, row = dimen.canaveral.behavior1[j,1], nrows = dimen.canaveral.behavior1[j,2], col = dimen.canaveral.behavior1[j,3], ncols = dimen.canaveral.behavior1[j,4], format = "matrix")
z <- OneDimensionTextureHilbert(img)
gamma.parameters <- fitdistr(z, "gamma")
gamma.results[j,] = c(unlist(gamma.parameters)[1], unlist(gamma.parameters)[2], unlist(gamma.parameters)[3], unlist(gamma.parameters)[4])
}
}
else if(option == 3){ #Cape Canaveral - behavior 2
sar_data <- raster(paste("../../Data/", "cape", "/HHHH", ".grd", sep = ""))
for(j in c(1:ns.canaveral.behavior2)){
img <- getValuesBlock(sar_data, row = dimen.canaveral.behavior2[j,1], nrows = dimen.canaveral.behavior2[j,2], col = dimen.canaveral.behavior2[j,3], ncols = dimen.canaveral.behavior2[j,4], format = "matrix")
z <- OneDimensionTextureHilbert(img)
gamma.parameters <- fitdistr(z, "gamma")
gamma.results[j,] = c(unlist(gamma.parameters)[1], unlist(gamma.parameters)[2], unlist(gamma.parameters)[3], unlist(gamma.parameters)[4])
}
}
else{ #Urban regions in Munich
sar_data <- raster(paste("../../Data/", "munich", "/HHHH", ".grd", sep = ""))
for(j in c(1:ns.munich)){
img <- getValuesBlock(sar_data, row = dimen.munich[j,1], nrows = dimen.munich[j,2], col = dimen.munich[j,3], ncols = dimen.munich[j,4], format = "matrix")
z <- OneDimensionTextureHilbert(img)
gamma.parameters <- fitdistr(z, "gamma")
gamma.results[j,] = c(unlist(gamma.parameters)[1], unlist(gamma.parameters)[2], unlist(gamma.parameters)[3], unlist(gamma.parameters)[4])
}
}
return(gamma.results)
}
gamma.guatemala <- Gamma.Estimation.Regions(1)
gamma.cape1 <- Gamma.Estimation.Regions(2)
gamma.cape2 <- Gamma.Estimation.Regions(3)
gamma.munich <- Gamma.Estimation.Regions(4)
